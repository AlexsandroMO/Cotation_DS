
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Documento Cotação</title>

<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

</head>
<body>

  <button class="pdf-button" onclick="generatePDF()">Gerar PDF</button>
  <button class="app-button" onclick="window.location.href='{{ url_for('db_app') }}'">DB_APP</button>

<div class="container" id="form-container">

  <!-- Cabeçalho -->
  <div class="header">
    <div class="logo">
      <!-- <img src="../Files/DS-Logo.png" alt="LOGO DS Grupo" /> -->
      <img src="{{ url_for('static', filename='DS-Logo.png') }}" alt="LOGO DS Grupo" />
    </div>
    <div class="header-info">
      <div class="line"><span class="label">DANIEL SANTOS ( DS GRUPO )</span></div>
      <div class="line"><span class="label">CNPJ:</span> 53.686.899.0001-04</div>
      <div class="line"><span class="label">INSC. EST.</span> 14.399.623</div>
      <div class="line"><span class="label">ANGRA DOS REIS - RJ</span></div>
      <div class="line"><span class="label">CONTATO:</span> DANIEL SANTOS</div>
      <div class="line"><span class="label">WHATSAPP:</span> (24) 99911 - 1553</div>
      <div class="line"><span class="label">E-MAIL:</span> ds.grupo@hotmail.com</div>
    </div>
    <div class="header-quote">
      COTAÇÃO Nº
      <small>DADOS DA COTAÇÃO</small>
      <div class="date">11/08/2025</div>
    </div>
  </div>

  <!-- Cliente -->
  <table class="client-info">
    <tbody>
      <tr><th>CLIENTE:</th><td>ELETRONUCLEAR S.A</td></tr>
      <tr><th>COTAÇÃO</th><td>DADOS DA COTAÇÃO</td></tr>
      <tr><th>ENDEREÇO:</th><td>ITAORNA, ANGRA DOS REIS - RJ</td></tr>
    <tr>
    <th>CONTATO:</th>
    <td class="col-contato" onclick="showSelect(this)">
        <span class="text-placeholder"></span>
        <select name="contato" id="contato-select" onchange="selectOption(this)">
        {% for comprador in compradores %}
            <option value="{{ comprador }}" {% if comprador == '' %}selected{% endif %}>{{ comprador }}</option>
        {% endfor %}
        </select>
    </td>
    </tr>
      <tr>
    <th>E-MAIL:</th>
    <td>
        <a href="#" id="email-link" href="#"></a>
    </td>
    </tr>
    </tbody>
  </table>

  <!-- Itens -->
  <table class="items-table">
    <thead>
      <tr>
        <th class="col-item">ITEM</th>
        <th class="col-un" contenteditable="true">UN</th>
        <th class="col-qtd" contenteditable="true">QTD</th>
        <th class="col-ncm">NCM</th>
        <th class="col-produto">PRODUTO / MODELO / MARCA</th>
        <th class="col-unitario" contenteditable="true">UNITÁRIO</th>
        <th class="col-subtotal" contenteditable="true">SUBTOTAL</th>
      </tr>
    </thead>
    <tbody id="table-body">
        {% for i in range(1, 2) %}
        <tr>
            <td class="col-item" contenteditable="true">{{ "%02d"|format(i) }}</td>
            <td class="col-un" onclick="showSelect(this)">
            <span class="text-placeholder"></span>
            <select onchange="selectUnit(this)">
                <option value="">---</option>
                {% for unit in units %}
                <option value="{{ unit }}">{{ unit }}</option>
                {% endfor %}
            </select>
            </td>
            <td class="col-qtd" contenteditable="true"></td>
            <td class="col-ncm"></td>
            <td class="col-produto" onclick="showSelect(this)">
            <span class="text-placeholder"></span>
            <select onchange="selectOption(this)">
                <option value="">---</option>
                {% for prod in products %}
                <option value="{{ prod }}">{{ prod }}</option>
                {% endfor %}
            </select>
            </td>
            <td class="col-unitario" contenteditable="true"></td>
            <td class="col-subtotal" contenteditable="true"></td>
        </tr>
        {% endfor %}
        </tbody>
  </table>

  <!-- Linha VALOR TOTAL -->
  <div style="
    display: flex;
    border: 1px solid #444;
    padding: 5px 10px;
    font-weight: bold;
    font-size: 14px;
    width: 100%;
    box-sizing: border-box;
    margin-top: 10px;
    ">
    <div style="flex: 1; text-align: center; border-right: 1px solid #444;">
      VALOR TOTAL:
    </div>
    <div style="width: 120px; text-align: right; padding-left: 10px;">
        <span id="total-value" contenteditable="true" style="display:inline-block; min-width: 60px; border-bottom: 1px dashed #999; outline: none; cursor: text;">0</span>
    </div>
  </div>
  <br>
  <!-- Seção final -->
  <div class="lower-block">
    <div class="line-item">
      <span class="label">PRAZO DE ENTREGA:</span>
      <span class="value" contenteditable="true">&emsp; &emsp; CIF - ATÉ 15 DIAS</span>
    </div>
    <div class="line-item">
      <span class="label">FORMA DE PAGAMENTO:</span>
      <span class="value" contenteditable="true">&emsp; &emsp; 30 DDL</span>
    </div>
    <div class="line-item">
      <span class="label accent">VALIDADE DA PROPOSTA:</span>
      <span class="value accent" contenteditable="true">&emsp; &emsp; 30 DIAS CORRIDOS</span>
    </div>

    <div class="bottom-note-row">
      Tudo o que você busca, com eficiência e confiança.
    </div>
  </div>


    <button id="add-row-btn" style="margin-top: 8px; padding: 6px 12px; font-size: 14px; cursor: pointer;">Adicionar linha</button>

</div>

<!-- Lib PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="{{ url_for('static', filename='scripts.js') }}"></script>

<script>
      // Atualiza data da cotação para a data atual no formato DD/MM/AAAA
  function updateQuoteDate() {
    const dateElem = document.querySelector('.header-quote .date');
    const today = new Date();
    const day = String(today.getDate()).padStart(2, '0');
    const month = String(today.getMonth() + 1).padStart(2, '0');
    const year = today.getFullYear();
    dateElem.textContent = `${day}/${month}/${year}`;
  }

  const contatoSelect = document.getElementById('contato-select');
  const emailLink = document.getElementById('email-link');

  contatoSelect.addEventListener('change', () => {
    const comprador = contatoSelect.value;

    fetch(`/get_email?comprador=${encodeURIComponent(comprador)}`)
      .then(response => response.json())
      .then(data => {
        if(data.email) {
          emailLink.textContent = data.email;
          emailLink.href = `mailto:${data.email}`;
        } else {
          emailLink.textContent = 'E-mail não disponível';
          emailLink.removeAttribute('href');
        }
      })
      .catch(() => {
        emailLink.textContent = 'Erro ao buscar e-mail';
        emailLink.removeAttribute('href');
      });
  });

</script>


</body>
</html>



